{"version":3,"sources":["../../app/scripts/payment.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,QAAQ,CAAC,IAAI,EAAE,CAAC;;AAEhB,IAAI,MAAM,GAAG,MAAM,CAAC,kCAAkC,CAAC,CAAC;AACxD,IAAI,QAAQ,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC;;AAEjC,IAAI,KAAK,GAAG;AACV,MAAI,EAAE;AACJ,SAAK,EAAE,OAAO;AACd,YAAQ,EAAE,MAAM;AAChB,cAAU,EAAE,MAAM;AAClB,iBAAa,EAAE,aAAa;AAC5B,mBAAe,EAAE;AACf,WAAK,EAAE,MAAM;KACd;GACF;AACD,SAAO,EAAE;AACP,SAAK,EAAE,SAAS;AAChB,YAAQ,EAAE;AACR,WAAK,EAAE,SAAS;KACjB;GACF;CACF,CAAC;;AAEF,IAAI,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE;AACjC,OAAK,EAAE,KAAK;CACb,CAAC,CAAC;AACH,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;;AAE5B,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,UAAS,KAAK,EAAE;AAC9C,MAAI,YAAY,GAAG,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;AAC1D,MAAI,KAAK,CAAC,KAAK,EAAE;AACf,gBAAY,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC;GAChD,MAAM;AACL,gBAAY,CAAC,WAAW,GAAG,EAAE,CAAC;GAC/B;CACF,CAAC,CAAC;;AAEH,SAAS,UAAU,CAAC,MAAM,EAAE;;AAE1B,MAAI,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;AACxD,MAAI,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;;;AAGpD,gBAAc,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AAC3C,cAAY,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;;AAEzC,MAAI,MAAM,CAAC,KAAK,EAAE;AAChB,QAAI,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;;AAEhD,QAAI,aAAa,GAAG;AAClB,YAAM,EAAE,IAAI,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC,KAAK,GAAG,GAAG;AACrE,cAAQ,EAAE,KAAK;AACf,iBAAW,EAAE,IAAI,CAAC,aAAa,CAAC,yBAAyB,CAAC,CAAC,KAAK;AAChE,UAAI,EAAE,IAAI,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC,KAAK;AAC7D,eAAS,EAAE,IAAI,CAAC,aAAa,CAAC,8BAA8B,CAAC,CAAC,KAAK;AACnE,WAAK,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;KACvB,CAAC;;AAEF,QAAI,aAAa,GAAG,CAAC,CAAC,kBAAkB,CAAC,CAAC,GAAG,EAAE,CAAC;;AAEhD,QAAI,aAAa,CAAC,WAAW,EAAE,KAAK,UAAU,CAAC,WAAW,EAAE,EAAE;AAC5D,UAAI,QAAQ,GAAG;AACb,eAAO,EAAE,IAAI;AACb,qBAAa,EAAE,IAAI;AACnB,iBAAS,EAAE,KAAK;AAChB,aAAK,EAAE,uDAAuD;AAC9D,gBAAQ,EAAE,MAAM;AAChB,iBAAS,EAAE;AACT,wBAAc,EAAE,kBAAkB;AAClC,yBAAe,EAAE,UAAU;SAC5B;AACD,qBAAa,EAAE,KAAK;AACpB,cAAM,EAAE,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC;OACtC,CAAC;;AAEF,OAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,UAAS,QAAQ,EAAE;AACvC,gBAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AAC5D,gBAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,SAAS,GAAG,+DAA+D,CAAC;OACvH,CAAC,CAAC,IAAI,CAAC,YAAW;AACjB,gBAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AAC5D,gBAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,SAAS,GAAG,kCAAkC,CAAC;OAC1F,CAAC,CAAC;KAEJ,MAAM;AACL,UAAI,QAAQ,GAAG;AACb,eAAO,EAAE,MAAM;AACf,qBAAa,EAAE,MAAM;AACrB,aAAK,EAAE,6DAA6D;AACpE,gBAAQ,EAAE,MAAM;AAChB,iBAAS,EAAE;AACT,wBAAc,EAAE,kBAAkB;AAClC,yBAAe,EAAE,UAAU;SAC5B;AACD,qBAAa,EAAE,KAAK;AACpB,cAAM,EAAE,IAAI,CAAC,SAAS,CAAC;AACrB,gBAAM,EAAE,IAAI,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC,KAAK;AAC/D,gBAAM,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;AACvB,gBAAM,EAAE,aAAa;AACrB,iBAAO,EAAE,IAAI,CAAC,aAAa,CAAC,8BAA8B,CAAC,CAAC,KAAK;SAClE,CAAC;OACH,CAAC;AACF,oBAAc,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;AACvC,OAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,UAAS,QAAQ,EAAE;AACvC,gBAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AAC5D,gBAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,SAAS,GAAG,+DAA+D,CAAC;AACtH,eAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;OACvB,CAAC,CAAC,IAAI,CAAC,YAAW;AACjB,gBAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AAC5D,gBAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,SAAS,GAAG,kCAAkC,CAAC;OAC1F,CAAC,CAAC;KAEJ;GACF,MAAM,IAAI,MAAM,CAAC,KAAK,EAAE;AACvB,YAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AAC5D,YAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;GACvF;CACF;;AAED,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,UAAS,KAAK,EAAE;AAChC,MAAI,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;AACxD,MAAI,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AACpD,gBAAc,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AAC3C,cAAY,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;CAC1C,CAAC,CAAC;;AAEH,IAAI,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;AACtD,UAAU,CAAC,gBAAgB,CAAC,QAAQ,EAAE,UAAS,CAAC,EAAE;AAChD,GAAC,CAAC,cAAc,EAAE,CAAC;AACnB,SAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;CACrB,CAAC,CAAC;;AAEH,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAS,CAAC,EAAE;AACtE,GAAC,CAAC,cAAc,EAAE,CAAC;;AAEnB,UAAQ,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;AAC5D,UAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;;AAE7D,MAAI,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,YAAY,EAAE;AAC9E,QAAI,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;AAChD,QAAI,YAAY,GAAG;AACjB,UAAI,EAAE,IAAI,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC,KAAK;AAC7D,mBAAa,EAAE,IAAI,CAAC,aAAa,CAAC,8BAA8B,CAAC,CAAC,KAAK;KACxE,CAAC;AACF,UAAM,CAAC,WAAW,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AACxD,YAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,SAAS,GAAG,OAAO,CAAC;GACvD,MAAM,IAAK,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,OAAO,EAAG;AAClF,kBAAc,EAAE,CAAC;AACjB,QAAI,CAAC,KAAK,EAAE,CAAC;;GAEd;CAEF,CAAC,CAAC;;AAGH,SAAS,cAAc,GAAG;AACxB,MAAI,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;AACxD,MAAI,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AACpD,gBAAc,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AAC3C,cAAY,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;;AAGzC,MAAI,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;AAChD,MAAI,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;AACzD,YAAU,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AACtC,MAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC,WAAW,GAAG,EAAE,CAAC;AACvD,MAAI,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC;AAC7D,MAAI,CAAC,aAAa,CAAC,yBAAyB,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC;AACzD,MAAI,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC;AAC7D,MAAI,CAAC,aAAa,CAAC,8BAA8B,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC;AAC9D,UAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC;AAC5C,UAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,SAAS,GAAG,YAAY,CAAC;AAC3D,cAAY,CAAC,WAAW,GAAG,EAAE,CAAC;CAC/B","file":"payment.js","sourcesContent":["'use strict';\n\nvalidate.init();\n\nvar stripe = Stripe('pk_live_O5tMiDSUfGsE7ISKk2jt3oSP');\nvar elements = stripe.elements();\n\nvar style = {\n  base: {\n    color: 'black',\n    fontSize: '20px',\n    lineHeight: '48px',\n    fontSmoothing: 'antialiased',\n    '::placeholder': {\n      color: '#ccc',\n    },\n  },\n  invalid: {\n    color: '#e5424d',\n    ':focus': {\n      color: '#303238',\n    },\n  },\n};\n\nvar card = elements.create('card', {\n  style: style\n});\ncard.mount('#card-element');\n\ncard.addEventListener('change', function(event) {\n  var displayError = document.getElementById('card-errors');\n  if (event.error) {\n    displayError.textContent = event.error.message;\n  } else {\n    displayError.textContent = '';\n  }\n});\n\nfunction setOutcome(result) {\n  // if (document.getElementById('donate').innerText === 'DONATE NOW') {\n  var successElement = document.querySelector('.success');\n  var errorElement = document.querySelector('.error');\n  // var progresscontainer = document.getElementById('progress');\n  // var lineProgressBar = Spinner().Colour('#f79f33');\n  successElement.classList.remove('visible');\n  errorElement.classList.remove('visible');\n\n  if (result.token) {\n    var form = document.getElementById('openModal');\n\n    var donateDetails = {\n      amount: form.querySelector('input[name=donation-amount]').value * 100,\n      currency: 'aud',\n      description: form.querySelector('input[name=description]').value,\n      name: form.querySelector('input[name=cardholder-name]').value,\n      useremail: form.querySelector('input[name=cardholder-email]').value,\n      token: result.token.id\n    };\n\n    var selectedlabel = $('#paymentSchedule').val();\n    //console.log(selectedlabel);\n    if (selectedlabel.toUpperCase() === 'Once off'.toUpperCase()) {\n      var settings = {\n        'async': true,\n        'crossDomain': true,\n        'timeout': 15000,\n        'url': 'https://expressroutes-sbyvubgxoj.now.sh/v1/donate/pay',\n        'method': 'POST',\n        'headers': {\n          'content-type': 'application/json',\n          'cache-control': 'no-cache'\n        },\n        'processData': false,\n        'data': JSON.stringify(donateDetails)\n      };\n\n      $.ajax(settings).done(function(response) {\n        document.getElementById('WaitImage').style.display = 'none';\n        document.getElementById('paymentMessage').innerText = 'Thank you for your payment. A receipt will be emailed to you.';\n      }).fail(function() {\n        document.getElementById('WaitImage').style.display = 'none';\n        document.getElementById('paymentMessage').innerText = 'Error occured. Please try later.';\n      });\n\n    } else {\n      var settings = {\n        'async': 'true',\n        'crossDomain': 'true',\n        'url': 'https://expressroutes-sbyvubgxoj.now.sh/v1/donate/subscribe',\n        'method': 'POST',\n        'headers': {\n          'content-type': 'application/json',\n          'cache-control': 'no-cache'\n        },\n        'processData': false,\n        'data': JSON.stringify({\n          'name': form.querySelector('input[name=cardholder-name]').value,\n          'card': result.token.id,\n          'plan': selectedlabel,\n          'email': form.querySelector('input[name=cardholder-email]').value\n        })\n      };\n      successElement.style.display = 'block';\n      $.ajax(settings).done(function(response) {\n        document.getElementById('WaitImage').style.display = 'none';\n        document.getElementById('paymentMessage').innerText = 'Thank you for your payment. A receipt will be emailed to you.';\n        console.log(response);\n      }).fail(function() {\n        document.getElementById('WaitImage').style.display = 'none';\n        document.getElementById('paymentMessage').innerText = 'Error occured. Please try later.';\n      });\n\n    }\n  } else if (result.error) {\n    document.getElementById('WaitImage').style.display = 'none';\n    document.getElementById('paymentMessage').innerText = JSON.parse(result.error).detail;\n  }\n}\n\ncard.on('change', function(event) {\n  var successElement = document.querySelector('.success');\n  var errorElement = document.querySelector('.error');\n  successElement.classList.remove('visible');\n  errorElement.classList.remove('visible');\n});\n\nvar formDonate = document.getElementById('openModal');\nformDonate.addEventListener('submit', function(e) {\n  e.preventDefault();\n  console.log('Test');\n});\n\ndocument.getElementById('donate').addEventListener('click', function(e) {\n  e.preventDefault();\n\n  document.getElementById('WaitNote').style.display = 'block';\n  document.getElementById('WaitImage').style.display = 'block';\n\n  if (document.getElementById('donate').innerText.toUpperCase() === 'DONATE NOW') {\n    var form = document.getElementById('openModal');\n    var extraDetails = {\n      name: form.querySelector('input[name=cardholder-name]').value,\n      receipt_email: form.querySelector('input[name=cardholder-email]').value\n    };\n    stripe.createToken(card, extraDetails).then(setOutcome);\n    document.getElementById('donate').innerText = 'CLOSE';\n  } else if ((document.getElementById('donate').innerText.toUpperCase() === 'CLOSE')) {\n    initialiseForm();\n    card.clear();\n    // window.location.href = window.location.href.split('#')[0] + '#closeModal';\n  }\n\n});\n\n\nfunction initialiseForm() {\n  var successElement = document.querySelector('.success');\n  var errorElement = document.querySelector('.error');\n  successElement.classList.remove('visible');\n  errorElement.classList.remove('visible');\n\n\n  var form = document.getElementById('openModal');\n  var formFields = document.getElementById('donateFields');\n  formFields.classList.remove('hidden');\n  form.querySelector('.success>p>span').textContent = '';\n  form.querySelector('input[name=donation-amount]').value = '';\n  form.querySelector('input[name=description]').value = '';\n  form.querySelector('input[name=cardholder-name]').value = '';\n  form.querySelector('input[name=cardholder-email]').value = '';\n  document.querySelector('.error').value = '';\n  document.getElementById('donate').innerText = 'Donate Now';\n  errorElement.textContent = '';\n}\n"]}